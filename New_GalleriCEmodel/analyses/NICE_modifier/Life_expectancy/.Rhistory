#' _____________________________________________________________________________
#' _____ 03_LE_and_YLL
#' Post-analysis processing
#' _____________________________________________________________________________
library(openxlsx)
results_path <- "~/GalleriCEmodel/analyses/NICE_modifier/Life_expectancy/Results/mcmc_5ysurv_splithaz/"
excel_output <- createWorkbook()
#' Create template dataframe with all potential combinations
df_all_combos <- expand.grid(Gender = c("Male","Female"),
`Cancer type` = c("Anus", "Bladder", "Breast", "Cervix", "Colon/Rectum", "Esophagus", "Gallbladder",
"Head and Neck", "Kidney", "Liver/Bile-duct", "Lung", "Lymphoma", "Melanoma", "Ovary",
"Pancreas", "Prostate", "Sarcoma", "Stomach", "Thyroid", "Urothelial Tract", "Uterus"),
Stage = c("I", "II", "III", "IV"),
Age = c("50-54","55-59","60-64","65-69","70-74","75-79"),
HR = c("1", "1andhalf", "3"),
`cfDNA status` = c("negative", "positive")) %>%
unite(characteristics, Gender:`cfDNA status`, sep = ".", remove = TRUE) %>%
left_join(list.files(path = results_path, pattern = "^LE") %>%
map_df(~read_csv(paste0(results_path, .))) %>%
mutate(characteristics = str_replace(characteristics, pattern = "1.5", "1andhalf")) %>%
select(characteristics) %>%
mutate(modelled = "Yes"),
by = c("characteristics")) %>%
filter(!grepl(c("Male.Cervix|Male.Breast|Female.Prostate|Male.Ovary|Male.Uterus"), characteristics)) %>%
#filter(!grepl(c("1andhalf|3"), characteristics) & grepl(c("negative"), characteristics)) %>%
separate_wider_delim(cols = characteristics, delim = ".", names = c("Gender", "Cancer type", "Stage", "Age", "HR", "cfDNA status"))
